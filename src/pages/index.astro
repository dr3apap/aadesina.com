---
import BaseHead from "../components/BaseHead.astro";
import Nav from "../components/Nav.astro";
import Header from "../components/Header.astro";
import About from "../components/About.astro";
import FeaturedDemos from "../components/FeatureDemos.astro"
import Demos from "../components/Demos.astro"
import Footer from "../components/Footer.astro";
import { SITE_TITLE, SITE_DESCRIPTION } from "../config";

---

<!DOCTYPE html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} ogTitle={SITE_TITLE} />
	</head>
	<body>
		<Nav/>	
		<Header/>
		<div class="p-8 mx-auto my-0 max-w-screen-md bg-brand-light-surface2">
		<main class="grid grid-flow-row gap-44">
			<About/>
			<FeaturedDemos/>
			<Demos/>
		</main>
		</div>
		<Footer />
	</body>
	<script is:inline>

SANITY_STUDIO_PROJECT_ID="f16qt5br"
SANITY_STUDIO_PROJECT_DATASET="production"

const allPostData = `
*[_type == 'post']{
  title, slug, body, publishedAt, category->{name},
  comment[]->{"commentBody":body, publishedAt, commenter->{"commenterAvatar":image, name}}, 
  author->{"avatar":image, name},
} | order(_createdAt desc)
`


 const getQueryUrl = (query) => {
const queryString = encodeURIComponent(query);
return `https://${SANITY_STUDIO_PROJECT_ID}.api.sanity.io/v2021-03-25/data/query/${SANITY_STUDIO_PROJECT_DATASET}?query=${queryString}`
}

 const getData = async (query) =>{
const QUERY_URL = getQueryUrl(query);
const DATA = await (await(await fetch(QUERY_URL)).json()).result;
return DATA;
}


 const getAllPostData = async () =>{
  return getData(allPostData);
}
console.log(getAllPostData());
</script>
</html>
